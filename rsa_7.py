import random
from Crypto.Util.number import getPrime, bytes_to_long
from secret import flag_7

def encrypt(m, n):
    digits = [2, 7, 0, 5]
    random.shuffle(digits)
    e = sum([d * 10 ** (3 - i) for i, d in enumerate(digits)])
    noise = random.randint(0, n - 1)
    return e, noise, pow(m + noise, e, n)

p = getPrime(512)
q = getPrime(512)
N = p * q
print("N =", N)
m = bytes_to_long(flag_7)
print('e1, noise1, c1 =', encrypt(m, N))
print('e2, noise2, c2 =', encrypt(m, N))

# N = 105120472431277971728287782677051055635620297348445271786141847539476362801631176340381979239649760872233776741048184460010955567915619314253010044913259894722939928242118791702203753483842621346603084603093753792391498611415022845393377526874367967115201520651654055476120842815152806492856285680583349247153
# e1, noise1, c1 = (7520, 79613345184732978904725070724289941281809964969078202100983116538377287688665837172415960182877526086161157987429001494858910493020725090431626600405425844672563010760110803748938645473417891466912935092625057313527147793566491944601771946380400767915744762344980483622576220214391152705993037800725389563704, 99076163539774352438887862248875433255330942799350585424668306772886988180109379982824677655147487442604951922242885974753884072457674263219241257114050435294550110560945198738072274068534590229777759135319517571318318325179909928804087019288208919446041418143062804906736343729805375997778581099515564689967)
# e2, noise2, c2 = (2075, 33242809358538541499173219758155891083424338318262292434348078619318463995844537918761633316614932588955616897323065493591294394382423684515161529432901770727616600015697168499008220343196685478799157801150256574095715460062939073574822016030614971298015375862374843278357533035325330010667577084790700213067, 24037839501148743775276595943606417200367866317070543889945237494010444229951567145415216358077726325707672168806349208281868043972631708625728983353377202633583795395981655859125478767076693722400949290102638599543740090047760438606174452607028278229424661018795562735970941110133757229028167960562357210467)